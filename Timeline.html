<svg
	style="height: {{((days.length + .5) * dayHeight) + daySquareStrokeWidth}}px; width: 600px"
>
	<TransitioningGroup visible={{showTimeline}}>
		{{#each days as day, i}}
			<rect
				y="{{impliedDayBorder + i * dayHeight}}"
				x="{{timelineLeft}}"
				width="{{dayWidth}}"
				height="{{dayHeight}}"
				class="day-box"
				stroke="{{navy}}"
				stroke-width="{{daySquareStrokeWidth}}"
			>
			</rect>
			<rect
				y="{{i * dayHeight}}"
				x="{{timelineLeft}}"
				width="{{dayWidth}}"
				height="{{dayHeight / 2}}"
				class="nighttime-box"
			>
			</rect>
			<rect
				y="{{i * dayHeight + (dayHeight * 0.5)}}"
				x="{{timelineLeft}}"
				width="{{dayWidth}}"
				height="{{dayHeight / 2}}"
				class="daylight-box"
			>
			</rect>
		{{/each}}
	</TransitioningGroup>


	<TransitioningGroup visible={{showDaylightNighttimeLabels}}>
		{{#each days as day, i}}
			<text
				x="{{ timelineLeft + (dayWidth / 2) }}"
				width="{{ dayWidth }}"
				y="{{ getDayY(i + .3) }}"
				fill="{{navy}}"
				text-anchor="middle"
			>
				Night
			</text>
			<text
				x="{{ timelineLeft + (dayWidth / 2) }}"
				width="{{ dayWidth }}"
				y="{{ getDayY(i + .8) }}"
				fill="{{navy}}"
				text-anchor="middle"
			>
				Day
			</text>
		{{/each}}
	</TransitioningGroup>



	<TransitioningGroup visible={{showWeekdayLabels}}>
		{{#each days as day, i}}
			<text
				y="{{getDayY(i + .8)}}"
				x="{{dayRightX + 20}}"
				text-anchor="start"
				fill="{{black}}"
			>
				{{day.weekday}}
			</text>
		{{/each}}
	</TransitioningGroup>

	<TransitioningGroup visible={{showFridaySundayRange}}>
		<rect
			y="{{ fridaySundayRangeY }}"
			x="{{ leftRangeBarX }}"
			width="{{ rangeBarWidth }}"
			height="{{ fridaySundayRangeHeight }}"
			fill="{{olive}}"
		>
		</rect>
		<Line
			stroke={{olive}}
			leftX={{leftRangeBarX - 20}}
			leftY={{fridaySundayRangeMidpoint}}
			rightX={{leftRangeBarX}}
			rightY={{fridaySundayRangeMidpoint}}
		/>
		<text
			y={{fridaySundayRangeMidpoint + textDistanceFromPointer}}
			x={{leftRangeBarX - 20 - textDistanceFromPointer}}
			width={{leftRangeBarX - 20 - textDistanceFromPointer}}
			text-anchor="end"
			fill="{{black}}"
		>
			Jesus's time in tomb (traditional)
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showDayOfMonth}}>
		{{#each days as day, i}}
			<text
				x="{{ timelineLeft + (dayWidth / 2) }}"
				width="{{ dayWidth }}"
				y="{{ getDayY(i + .8) }}"
				fill="{{navy}}"
				text-anchor="middle"
			>
				{{day.number}}
			</text>
		{{/each}}
	</TransitioningGroup>

	<TransitioningGroup visible={{showLambSacrificed}}>
		<Line
			rightX={{dayLeftX}}
			rightY={{lambSacrificedY}}
			leftX={{dayLeftX - 50}}
			leftY={{lambSacrificedY - 24}}
		/>
		<text
			y="{{lambSacrificedY - 24 + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - 50 - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			Lamb sacrificed
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showHighSabbath}}>
		<rect
			y="{{ highSabbathRangeY }}"
			x="{{ leftRangeBarX }}"
			width="{{ rangeBarWidth }}"
			height="{{ highSabbathRangeHeight }}"
			fill="{{green}}"
		>
		</rect>
		<Line
			rightX={{dayLeftX}}
			rightY={{highSabbathMidpointY}}
			leftX={{dayLeftX - 50}}
			leftY={{highSabbathMidpointY}}
			stroke={{green}}
		/>
		<text
			y="{{highSabbathMidpointY + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			High Sabbath
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showLambSupperEaten}}>
		<Line
			rightX={{dayLeftX}}
			rightY={{lambEatenY}}
			leftX={{dayLeftX - 50}}
			leftY={{lambEatenY}}
		/>
		<text
			y={{lambEatenY + textDistanceFromPointer}}
			x={{dayLeftX - 50 - textDistanceFromPointer}}
			width={{dayLeftX - textDistanceFromPointer}}
			text-anchor="end"
			fill="{{black}}"
		>
			Lamb supper eaten
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showFeastOfUnleavenedBread}}>
		<rect
			y={{ getDayY(1) }}
			x={{ dayRightX }}
			width={{ rangeBarWidth }}
			height={{ dayHeight * 3.2 }}
			fill="{{red}}"
		>
		</rect>
		<polygon
			points="{{dayRightX - 8}},{{getDayY(4.2)}} {{dayRightX + rangeBarWidth + 8}},{{getDayY(4.2)}} {{dayRightX + (rangeBarWidth / 2)}},{{getDayY(4.2) + rangeBarWidth}}"
			fill="{{red}}"
		/>
		<Line
			rightX={{dayRightX + 50}}
			rightY={{ getDayY(2) }}
			leftX={{dayRightX}}
			leftY={{ getDayY(2) }}
			stroke={{red}}
		/>
		<text
			y={{ getDayY(2) - textDistanceFromPointer }}
			x={{ dayRightX + 50 + textDistanceFromPointer }}
			width="140"
			text-anchor="start"
			fill="{{black}}"
		>
			Feast of
		</text>
		<text
			y={{ getDayY(2) + 16 }}
			x={{ dayRightX + 50 + textDistanceFromPointer }}
			width="140"
			text-anchor="start"
			fill="{{black}}"
		>
			Unleavened Bread
		</text>
	</TransitioningGroup>


	<TransitioningGroup visible={{showCrucifixion}}>
		<Line
			rightX={{dayLeftX}}
			rightY={{lambSacrificedY}}
			leftX={{dayLeftX - 50}}
			leftY={{lambSacrificedY}}
		/>
		<text
			y="{{lambSacrificedY + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - 50 - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			Jesus crucified
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showBuried}}>
		<Line
			rightX={{dayLeftX}}
			rightY={{burialY}}
			leftX={{dayLeftX - 50}}
			leftY={{burialY + 20}}
		/>
		<text
			y="{{burialY + 20 + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - 50 - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			Jesus buried
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showLastSupper}}>
		<Line
			rightX={{dayLeftX}}
			rightY={{lastSupperY}}
			leftX={{dayLeftX - 50}}
			leftY={{lastSupperY}}
		/>
		<text
			y="{{lastSupperY + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - 50 - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			Last supper
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showWeeklySabbath}}>
		<rect
			y="{{ weeklySabbathRangeY }}"
			x="{{ leftRangeBarX }}"
			width="{{ rangeBarWidth }}"
			height="{{ weeklySabbathRangeHeight }}"
			fill="{{fuchsia}}"
		>
		</rect>
		<Line
			rightX={{dayLeftX}}
			rightY={{weeklySabbathMidpointY}}
			leftX={{dayLeftX - 50}}
			leftY={{weeklySabbathMidpointY}}
			stroke={{fuchsia}}
		/>
		<text
			y="{{weeklySabbathMidpointY + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			Weekly Sabbath
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showResurrection}}>
		<Line
			rightX={{dayLeftX}}
			rightY={{resurrectionY}}
			leftX={{dayLeftX - 50}}
			leftY={{resurrectionY}}
		/>
		<text
			y="{{resurrectionY + textDistanceFromPointer}}"
			x="{{dayLeftX - 50 - textDistanceFromPointer}}"
			width="{{dayLeftX - 50 - textDistanceFromPointer}}"
			text-anchor="end"
			fill="{{black}}"
		>
			Resurrection
		</text>
	</TransitioningGroup>

	<TransitioningGroup visible={{showTimeFromBurialToResurrection}}>
		<rect
			y="{{ burialY }}"
			x="{{ leftRangeBarX }}"
			width="{{ rangeBarWidth }}"
			height="{{ resurrectionY - burialY }}"
			fill="{{olive}}"
		>
		</rect>
		<Line
			stroke={{olive}}
			leftX={{leftRangeBarX - 20}}
			leftY={{timeInTombMidpointY}}
			rightX={{leftRangeBarX}}
			rightY={{timeInTombMidpointY}}
		/>
		<text
			y={{timeInTombMidpointY + textDistanceFromPointer}}
			x={{leftRangeBarX - 20 - textDistanceFromPointer}}
			width={{leftRangeBarX - 20 - textDistanceFromPointer}}
			text-anchor="end"
			fill="{{black}}"
		>
			Jesus's time in tomb
		</text>
	</TransitioningGroup>
</svg>

<style>
@import "./variables";

.day-box {
	fill: transparent;
}

.daylight-box {
	fill: $yellow;
	fill-opacity: 0.5;
}
.nighttime-box {
	fill: $gray;
	fill-opacity: 0.5;
}

:global(text) {
	font-size: 16px;
}
</style>

<script>
import TransitioningGroup from './TransitioningGroup.html'
import Line from './Line.html'
import combine from 'combine-arrays'

import * as colors from './colors.js'

export default {
	data() {
		return Object.assign({
			days: combine({
				number: [ 14, 15, 16, 17 ],
				weekday: [ `Thursday`, `Friday`, `Saturday`, `Sunday` ],
			}),
			dayHeight: 100,
			dayWidth: 100,
			daySquareStrokeWidth: 2,
			timelineLeft: 300,
			rangeBarWidth: 20,
			textDistanceFromPointer: 4,
		}, colors)
	},
	computed: {
		impliedDayBorder: daySquareStrokeWidth => daySquareStrokeWidth / 2,
		highlightedDays: (showFridayHighlight, showSundayHighlight) => [
			false,
			showFridayHighlight,
			false,
			showSundayHighlight,
		],
		getDayY: (dayHeight, impliedDayBorder) => dayPosition =>
			impliedDayBorder + (dayHeight * dayPosition),
		dayLeftX: (timelineLeft, impliedDayBorder) =>
			timelineLeft - impliedDayBorder,
		dayRightX: (timelineLeft, dayWidth, impliedDayBorder) =>
			timelineLeft + dayWidth + impliedDayBorder,
		leftRangeBarX: (dayLeftX, rangeBarWidth) =>
			dayLeftX - rangeBarWidth,


		fridaySundayRangeY: getDayY => getDayY(1.875),
		fridaySundayRangeHeight: dayHeight => dayHeight * 1.5,
		fridaySundayRangeMidpoint: (fridaySundayRangeY, fridaySundayRangeHeight) =>
			fridaySundayRangeY + (fridaySundayRangeHeight / 2),

		lambSacrificedY: getDayY => getDayY(0.875),
		lambEatenY: getDayY => getDayY(1.05),

		highSabbathRangeY: getDayY => getDayY(1),
		highSabbathRangeHeight: (getDayY, highSabbathRangeY) =>
			getDayY(2) - highSabbathRangeY,
		highSabbathMidpointY: (highSabbathRangeY, highSabbathRangeHeight) =>
			highSabbathRangeY + (highSabbathRangeHeight / 2),

		weeklySabbathRangeY: getDayY => getDayY(2),
		weeklySabbathRangeHeight: (getDayY, weeklySabbathRangeY) =>
			getDayY(3) - weeklySabbathRangeY,
		weeklySabbathMidpointY: (weeklySabbathRangeY, weeklySabbathRangeHeight) =>
			weeklySabbathRangeY + (weeklySabbathRangeHeight / 2),


		burialY: getDayY => getDayY(0.95),
		resurrectionY: getDayY => getDayY(3.25),

		lastSupperY: getDayY => getDayY(0.05),

		timeInTombMidpointY: (burialY, resurrectionY) =>
			burialY + ((resurrectionY - burialY) / 2),

	},
	components: {
		TransitioningGroup,
		Line,
	},
}
</script>
